# 中英混排引号检测规则

文档描述的对象为中英混排文本，且使用了 `U+2018, U+2019, U+201c, U+201d` 作为单/双引号。

文档内，英文引号使用的可能是 ASCII 引号：`'` 和 `"`。

文档所述的“中文引号”与“英文引号”，均使用上述编码，实际上是同一个字符。所说的“中文”、“英文”前缀代指使用什么字体渲染。

文档假设所解析文本的引号的使用是正确的。但与空格相关的规则（最好）不应作为强依赖，下文亦有所述，[也可参考](https://www.zhihu.com/question/19587406)。

文档内的“英文单/双引号”，主要目的在于“使用正确字体渲染”。需要注意英文单引号既可以指引号，也可能指撇号：但二者均使用英文字体渲染，因此可统称为“英文引号”。撇号规则仅做解析时处理用。

中文字符包含除引号外的中文标点，如：`，、。！？`。

文档提到的中文字符，可能可以替换为全宽字符。鉴于本文的目的是中英混排，故使用中文字符。

## 解析规则

### 公用规则（英文引号）

- 当单/双引号内含任意中文字符时，该单/双引号是中文引号。

### 双引号（中英区分规则）

### 单引号（中英区分规则）

- 英文双引号内的单引号均为英文。

### 单引号（英文撇号规则）

- 不在双引号内的闭单引号为撇号。
- 闭单引号不能匹配开单引号时为撇号。
- 当一个闭单引号前是其他标点符号时，它不是撇号。
  - 注意这条规则潜在要求句间需要加空格，例如：`He left, 'cause I told him so.`。
- 当一个闭单引号前是字母，且其后也是字母时，它是撇号（`it's`）。
- 当一个闭单引号前是字母，但其后是空格或闭双引号时，它*可能*是闭单引号或撇号。
- 当一个闭单引号前是空格或无字符，且其后是字母时，它是撇号（`'cause`）。

## 排版规则（非强制）

本规则的主要原则如下：

- 中文不存在空格。
  - 中文的句间距依赖全宽标点实现。
- 英文的句间距依赖“间隙”实现，大多数时候，它是空格。
  - 以网页排版为例，间隙完全可以实现为 margin 或 padding 或是什么别的东西。因此它不一定是空格。
- 中文标点在混排时，可视为已经带有“间隙”的英文标点。
- 由于引号的特殊性，以及中英字体引号的显示效果差异，引号左右是否添加“间隙”取决于它是“中文引号”还是“英文引号”，也即以什么字体渲染。

规则列表：

- 开引号后、闭引号前，不应该存在间隙。
- 引号不应该前后均是间隙。
- 引号内应该有内容。
- 中文标点附近的英文不应当添加间隙。
- 当使用英文引号时，若开引号前、闭引号后不是中文标点符号，那么应加间隙。

## 正确混排范例

[中英文混排：自动处理引号](https://lingsamuel.github.io/page/2021-03-02-中英文混排自动处理引号/)

![image](https://user-images.githubusercontent.com/14567045/109782177-8ae74f00-7c43-11eb-9f7d-c8302b58968a.png)
